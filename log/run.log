2025-12-10 20:41:33,324 - INFO - ================================================================================
2025-12-10 20:41:33,325 - INFO - FLAG PATTERN CLASSIFICATION EXPERIMENT
2025-12-10 20:41:33,326 - INFO - Experiment started at: 2025-12-10 20:41:33
2025-12-10 20:41:33,327 - INFO - ================================================================================
2025-12-10 20:41:33,327 - INFO - Using preprocessed file: /work/data/export/segments_preproc_24.csv
2025-12-10 20:41:33,330 - INFO - PyTorch Lightning version: 2.6.0
2025-12-10 20:41:33,350 - INFO - CUDA available: True
2025-12-10 20:41:33,351 - INFO - PyTorch version: 2.6.0+cu124
2025-12-10 20:41:33,366 - INFO - 
================================================================================
2025-12-10 20:41:33,367 - INFO - CONFIGURATION - Random Seed
2025-12-10 20:41:33,367 - INFO - ================================================================================
2025-12-10 20:41:33,368 - INFO - Random seed set to: 1
2025-12-10 20:41:33,369 - INFO - This ensures reproducible results across runs
2025-12-10 20:41:33,385 - INFO - 
================================================================================
2025-12-10 20:41:33,387 - INFO - CONFIGURATION - Primary Evaluation Metric
2025-12-10 20:41:33,388 - INFO - ================================================================================
2025-12-10 20:41:33,389 - INFO - Primary metric: PR-AUC (macro)
2025-12-10 20:41:33,390 - INFO - Monitor: val_pr_auc
2025-12-10 20:41:33,390 - INFO - Description: Precision-Recall curve area (macro): better for imbalanced classes
2025-12-10 20:41:33,391 - INFO - Higher is better: True
2025-12-10 20:41:33,451 - INFO - 
================================================================================
2025-12-10 20:41:33,452 - INFO - DATA PROCESSING - Loading and Preparing Data
2025-12-10 20:41:33,453 - INFO - ================================================================================
2025-12-10 20:41:33,467 - INFO - Loaded preprocessed data: 3096 rows, 12 columns
2025-12-10 20:41:33,470 - INFO - Feature columns (8): ['open_norm', 'high_norm', 'low_norm', 'close_norm', 'vol_close', 'vol_high_low', 'compression_ratio', 'trend']
2025-12-10 20:41:33,495 - INFO - Data shape: 129 segments × 24 timesteps × 8 features
2025-12-10 20:41:33,496 - INFO - Label distribution:
2025-12-10 20:41:33,497 - INFO -   Bullish Normal: 36 samples (27.9%)
2025-12-10 20:41:33,497 - INFO -   Bearish Normal: 24 samples (18.6%)
2025-12-10 20:41:33,498 - INFO -   Bearish Pennant: 23 samples (17.8%)
2025-12-10 20:41:33,499 - INFO -   Bullish Pennant: 20 samples (15.5%)
2025-12-10 20:41:33,499 - INFO -   Bearish Wedge: 13 samples (10.1%)
2025-12-10 20:41:33,500 - INFO -   Bullish Wedge: 13 samples (10.1%)
2025-12-10 20:41:33,501 - INFO - Data loading and preprocessing completed successfully
2025-12-10 20:41:33,527 - INFO - 
Label encoding: 6 classes
2025-12-10 20:41:33,528 - INFO -   'Bearish Normal' → 0
2025-12-10 20:41:33,529 - INFO -   'Bearish Pennant' → 1
2025-12-10 20:41:33,530 - INFO -   'Bearish Wedge' → 2
2025-12-10 20:41:33,531 - INFO -   'Bullish Normal' → 3
2025-12-10 20:41:33,532 - INFO -   'Bullish Pennant' → 4
2025-12-10 20:41:33,533 - INFO -   'Bullish Wedge' → 5
2025-12-10 20:41:33,558 - INFO - 
================================================================================
2025-12-10 20:41:33,559 - INFO - DATA SPLIT - Train/Validation
2025-12-10 20:41:33,560 - INFO - ================================================================================
2025-12-10 20:41:33,560 - INFO - Training segments: 103 (79.8%)
2025-12-10 20:41:33,561 - INFO - Validation segments: 26 (20.2%)
2025-12-10 20:41:33,562 - INFO - Split ratio: 80/20 (stratified by label)
2025-12-10 20:41:33,563 - INFO - 
Class distribution (all data):
2025-12-10 20:41:33,564 - INFO -   Class 0 (Bearish Normal): 24 samples, weight: 0.7892
2025-12-10 20:41:33,564 - INFO -   Class 1 (Bearish Pennant): 23 samples, weight: 0.8235
2025-12-10 20:41:33,565 - INFO -   Class 2 (Bearish Wedge): 13 samples, weight: 1.4570
2025-12-10 20:41:33,566 - INFO -   Class 3 (Bullish Normal): 36 samples, weight: 0.5261
2025-12-10 20:41:33,567 - INFO -   Class 4 (Bullish Pennant): 20 samples, weight: 0.9471
2025-12-10 20:41:33,567 - INFO -   Class 5 (Bullish Wedge): 13 samples, weight: 1.4570
2025-12-10 20:41:33,632 - INFO - 
================================================================================
2025-12-10 20:41:33,633 - INFO - MODEL ARCHITECTURE
2025-12-10 20:41:33,634 - INFO - ================================================================================
2025-12-10 20:41:33,635 - INFO - FlagPatternClassifier(
  (conv): Sequential(
    (0): Conv1d(8, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    (5): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Dropout(p=0.1, inplace=False)
    (8): Conv1d(64, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (9): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU()
    (11): Dropout(p=0.1, inplace=False)
    (12): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (13): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU()
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=32, bias=True)
    (4): ReLU()
    (5): Linear(in_features=32, out_features=6, bias=True)
  )
  (criterion): CrossEntropyLoss()
)
2025-12-10 20:41:33,636 - INFO - 
Total parameters: 99,238
2025-12-10 20:41:33,636 - INFO - Trainable parameters: 99,238
2025-12-10 20:41:33,637 - INFO - Non-trainable parameters: 0
2025-12-10 20:41:33,712 - INFO - 
================================================================================
2025-12-10 20:41:33,713 - INFO - CONFIGURATION - Training Hyperparameters
2025-12-10 20:41:33,713 - INFO - ================================================================================
2025-12-10 20:41:33,714 - INFO - Maximum epochs: 50
2025-12-10 20:41:33,715 - INFO - Batch size: 12
2025-12-10 20:41:33,715 - INFO - Learning rate: 0.001
2025-12-10 20:41:33,716 - INFO - Weight decay: 0.0001
2025-12-10 20:41:33,717 - INFO - Optimizer: AdamW
2025-12-10 20:41:33,718 - INFO - LR Scheduler: CosineAnnealingLR (T_max=20)
2025-12-10 20:41:33,718 - INFO - Loss function: CrossEntropyLoss (with class weights)
2025-12-10 20:41:33,720 - INFO - Accelerator: GPU
2025-12-10 20:41:33,720 - INFO - Checkpoint directory: /work/data/export/checkpoints_v2
2025-12-10 20:41:33,721 - INFO - Model selection metric: PR-AUC (macro)
2025-12-10 20:41:33,722 - INFO - Monitor: val_pr_auc (mode: max)
2025-12-10 20:41:33,739 - INFO - 
================================================================================
2025-12-10 20:41:33,741 - INFO - TRAINING PROGRESS
2025-12-10 20:41:33,742 - INFO - ================================================================================
2025-12-10 20:41:33,742 - INFO - Training started at: 2025-12-10 20:41:33
2025-12-10 20:41:34,247 - INFO - Epoch 0 - VAL | Loss: 1.8001 | Acc: 0.2500 | F1: 0.0667 | PR-AUC: 0.2644 | AUC-OvO: 0.4826 | AUC-OvR: 0.4782
2025-12-10 20:41:34,449 - INFO - Epoch 0 - VAL | Loss: 1.7689 | Acc: 0.2308 | F1: 0.1761 | PR-AUC: 0.2723 | AUC-OvO: 0.5132 | AUC-OvR: 0.5152
2025-12-10 20:41:34,473 - INFO - Epoch 0 - TRAIN | Loss: 1.8196 | Acc: 0.2524 | F1: 0.1380 | PR-AUC: 0.2117 | AUC-OvO: 0.5327 | AUC-OvR: 0.5312
2025-12-10 20:41:34,627 - INFO - Epoch 1 - VAL | Loss: 1.7138 | Acc: 0.0769 | F1: 0.0522 | PR-AUC: 0.3525 | AUC-OvO: 0.5536 | AUC-OvR: 0.5629
2025-12-10 20:41:34,649 - INFO - Epoch 1 - TRAIN | Loss: 1.7822 | Acc: 0.2136 | F1: 0.1838 | PR-AUC: 0.2349 | AUC-OvO: 0.5975 | AUC-OvR: 0.5996
2025-12-10 20:41:34,794 - INFO - Epoch 2 - VAL | Loss: 1.6750 | Acc: 0.1923 | F1: 0.1513 | PR-AUC: 0.2905 | AUC-OvO: 0.6152 | AUC-OvR: 0.6131
2025-12-10 20:41:34,818 - INFO - Epoch 2 - TRAIN | Loss: 1.6224 | Acc: 0.2913 | F1: 0.2122 | PR-AUC: 0.3259 | AUC-OvO: 0.6899 | AUC-OvR: 0.6973
2025-12-10 20:41:34,914 - INFO - Epoch 3 - VAL | Loss: 1.6820 | Acc: 0.2308 | F1: 0.1615 | PR-AUC: 0.3532 | AUC-OvO: 0.6807 | AUC-OvR: 0.6759
2025-12-10 20:41:34,941 - INFO - Epoch 3 - TRAIN | Loss: 1.5203 | Acc: 0.3301 | F1: 0.2588 | PR-AUC: 0.3846 | AUC-OvO: 0.7497 | AUC-OvR: 0.7548
2025-12-10 20:41:35,081 - INFO - Epoch 4 - VAL | Loss: 1.6341 | Acc: 0.2308 | F1: 0.1637 | PR-AUC: 0.3825 | AUC-OvO: 0.6950 | AUC-OvR: 0.7020
2025-12-10 20:41:35,106 - INFO - Epoch 4 - TRAIN | Loss: 1.4983 | Acc: 0.3301 | F1: 0.2494 | PR-AUC: 0.3570 | AUC-OvO: 0.7566 | AUC-OvR: 0.7649
2025-12-10 20:41:35,249 - INFO - Epoch 5 - VAL | Loss: 1.6171 | Acc: 0.1923 | F1: 0.1414 | PR-AUC: 0.3374 | AUC-OvO: 0.6972 | AUC-OvR: 0.7003
2025-12-10 20:41:35,274 - INFO - Epoch 5 - TRAIN | Loss: 1.4288 | Acc: 0.3981 | F1: 0.3269 | PR-AUC: 0.4337 | AUC-OvO: 0.7939 | AUC-OvR: 0.7963
2025-12-10 20:41:35,367 - INFO - Epoch 6 - VAL | Loss: 1.6016 | Acc: 0.0769 | F1: 0.0694 | PR-AUC: 0.3048 | AUC-OvO: 0.6735 | AUC-OvR: 0.6812
2025-12-10 20:41:35,402 - INFO - Epoch 6 - TRAIN | Loss: 1.3945 | Acc: 0.3495 | F1: 0.2920 | PR-AUC: 0.4296 | AUC-OvO: 0.8069 | AUC-OvR: 0.8087
2025-12-10 20:41:35,542 - INFO - Epoch 7 - VAL | Loss: 1.5613 | Acc: 0.1923 | F1: 0.1303 | PR-AUC: 0.3265 | AUC-OvO: 0.7002 | AUC-OvR: 0.7039
2025-12-10 20:41:35,573 - INFO - Epoch 7 - TRAIN | Loss: 1.3843 | Acc: 0.3786 | F1: 0.3000 | PR-AUC: 0.4298 | AUC-OvO: 0.8128 | AUC-OvR: 0.8137
2025-12-10 20:41:35,676 - INFO - Epoch 8 - VAL | Loss: 1.5815 | Acc: 0.2692 | F1: 0.1859 | PR-AUC: 0.3214 | AUC-OvO: 0.6947 | AUC-OvR: 0.6971
2025-12-10 20:41:35,698 - INFO - Epoch 8 - TRAIN | Loss: 1.3100 | Acc: 0.4854 | F1: 0.4263 | PR-AUC: 0.4907 | AUC-OvO: 0.8326 | AUC-OvR: 0.8334
2025-12-10 20:41:35,849 - INFO - Epoch 9 - VAL | Loss: 1.6816 | Acc: 0.2692 | F1: 0.1923 | PR-AUC: 0.3133 | AUC-OvO: 0.6809 | AUC-OvR: 0.6866
2025-12-10 20:41:35,896 - INFO - Epoch 9 - TRAIN | Loss: 1.2851 | Acc: 0.4175 | F1: 0.3393 | PR-AUC: 0.4688 | AUC-OvO: 0.8214 | AUC-OvR: 0.8247
2025-12-10 20:41:36,038 - INFO - Epoch 10 - VAL | Loss: 1.6631 | Acc: 0.2692 | F1: 0.2145 | PR-AUC: 0.3305 | AUC-OvO: 0.6825 | AUC-OvR: 0.6911
2025-12-10 20:41:36,069 - INFO - Epoch 10 - TRAIN | Loss: 1.3687 | Acc: 0.3981 | F1: 0.3420 | PR-AUC: 0.4737 | AUC-OvO: 0.8150 | AUC-OvR: 0.8135
2025-12-10 20:41:36,229 - INFO - Epoch 11 - VAL | Loss: 1.6007 | Acc: 0.1538 | F1: 0.1322 | PR-AUC: 0.3383 | AUC-OvO: 0.6906 | AUC-OvR: 0.7006
2025-12-10 20:41:36,261 - INFO - Epoch 11 - TRAIN | Loss: 1.2704 | Acc: 0.3786 | F1: 0.3703 | PR-AUC: 0.4317 | AUC-OvO: 0.8262 | AUC-OvR: 0.8264
2025-12-10 20:41:36,371 - INFO - Epoch 12 - VAL | Loss: 1.5683 | Acc: 0.1154 | F1: 0.1120 | PR-AUC: 0.3052 | AUC-OvO: 0.6720 | AUC-OvR: 0.6821
2025-12-10 20:41:36,395 - INFO - Epoch 12 - TRAIN | Loss: 1.1957 | Acc: 0.4854 | F1: 0.4607 | PR-AUC: 0.5024 | AUC-OvO: 0.8585 | AUC-OvR: 0.8612
2025-12-10 20:41:36,523 - INFO - Epoch 13 - VAL | Loss: 1.5621 | Acc: 0.1154 | F1: 0.1120 | PR-AUC: 0.3033 | AUC-OvO: 0.6752 | AUC-OvR: 0.6840
2025-12-10 20:41:36,559 - INFO - Epoch 13 - TRAIN | Loss: 1.2514 | Acc: 0.4854 | F1: 0.4708 | PR-AUC: 0.4634 | AUC-OvO: 0.8373 | AUC-OvR: 0.8347
2025-12-10 20:41:36,692 - INFO - Epoch 14 - VAL | Loss: 1.5558 | Acc: 0.1538 | F1: 0.1491 | PR-AUC: 0.3330 | AUC-OvO: 0.6991 | AUC-OvR: 0.7006
2025-12-10 20:41:36,735 - INFO - Epoch 14 - TRAIN | Loss: 1.1968 | Acc: 0.4466 | F1: 0.4284 | PR-AUC: 0.5591 | AUC-OvO: 0.8445 | AUC-OvR: 0.8457
2025-12-10 20:41:36,862 - INFO - Epoch 15 - VAL | Loss: 1.5578 | Acc: 0.1538 | F1: 0.1481 | PR-AUC: 0.3011 | AUC-OvO: 0.6797 | AUC-OvR: 0.6877
2025-12-10 20:41:36,891 - INFO - Epoch 15 - TRAIN | Loss: 1.1671 | Acc: 0.4757 | F1: 0.4554 | PR-AUC: 0.5792 | AUC-OvO: 0.8678 | AUC-OvR: 0.8659
2025-12-10 20:41:37,018 - INFO - Epoch 16 - VAL | Loss: 1.5660 | Acc: 0.1923 | F1: 0.1696 | PR-AUC: 0.3138 | AUC-OvO: 0.6919 | AUC-OvR: 0.6971
2025-12-10 20:41:37,052 - INFO - Epoch 16 - TRAIN | Loss: 1.2673 | Acc: 0.4660 | F1: 0.4339 | PR-AUC: 0.4771 | AUC-OvO: 0.8291 | AUC-OvR: 0.8285
2025-12-10 20:41:37,186 - INFO - Epoch 17 - VAL | Loss: 1.5707 | Acc: 0.2308 | F1: 0.1999 | PR-AUC: 0.3110 | AUC-OvO: 0.6935 | AUC-OvR: 0.6982
2025-12-10 20:41:37,234 - INFO - Epoch 17 - TRAIN | Loss: 1.2109 | Acc: 0.4175 | F1: 0.3980 | PR-AUC: 0.5333 | AUC-OvO: 0.8534 | AUC-OvR: 0.8524
2025-12-10 20:41:37,363 - INFO - Epoch 18 - VAL | Loss: 1.5685 | Acc: 0.2308 | F1: 0.1999 | PR-AUC: 0.3079 | AUC-OvO: 0.6852 | AUC-OvR: 0.6939
2025-12-10 20:41:37,418 - INFO - Epoch 18 - TRAIN | Loss: 1.2031 | Acc: 0.4175 | F1: 0.3877 | PR-AUC: 0.4966 | AUC-OvO: 0.8463 | AUC-OvR: 0.8451
2025-12-10 20:41:37,597 - INFO - Epoch 19 - VAL | Loss: 1.5496 | Acc: 0.2308 | F1: 0.1999 | PR-AUC: 0.3107 | AUC-OvO: 0.6878 | AUC-OvR: 0.6950
2025-12-10 20:41:37,635 - INFO - Epoch 19 - TRAIN | Loss: 1.1667 | Acc: 0.4757 | F1: 0.4697 | PR-AUC: 0.5005 | AUC-OvO: 0.8540 | AUC-OvR: 0.8525
2025-12-10 20:41:37,783 - INFO - Epoch 20 - VAL | Loss: 1.5698 | Acc: 0.2308 | F1: 0.2029 | PR-AUC: 0.3080 | AUC-OvO: 0.6871 | AUC-OvR: 0.6912
2025-12-10 20:41:37,832 - INFO - Epoch 20 - TRAIN | Loss: 1.2473 | Acc: 0.3786 | F1: 0.3676 | PR-AUC: 0.4553 | AUC-OvO: 0.8318 | AUC-OvR: 0.8318
2025-12-10 20:41:38,010 - INFO - Epoch 21 - VAL | Loss: 1.5405 | Acc: 0.1923 | F1: 0.1704 | PR-AUC: 0.3084 | AUC-OvO: 0.6853 | AUC-OvR: 0.6903
2025-12-10 20:41:38,064 - INFO - Epoch 21 - TRAIN | Loss: 1.1854 | Acc: 0.4563 | F1: 0.4519 | PR-AUC: 0.5147 | AUC-OvO: 0.8623 | AUC-OvR: 0.8595
2025-12-10 20:41:38,239 - INFO - Epoch 22 - VAL | Loss: 1.5693 | Acc: 0.1923 | F1: 0.1741 | PR-AUC: 0.3090 | AUC-OvO: 0.6849 | AUC-OvR: 0.6903
2025-12-10 20:41:38,291 - INFO - Epoch 22 - TRAIN | Loss: 1.2083 | Acc: 0.4660 | F1: 0.4399 | PR-AUC: 0.5074 | AUC-OvO: 0.8491 | AUC-OvR: 0.8539
2025-12-10 20:41:38,470 - INFO - Epoch 23 - VAL | Loss: 1.5592 | Acc: 0.1923 | F1: 0.1741 | PR-AUC: 0.3101 | AUC-OvO: 0.6898 | AUC-OvR: 0.6938
2025-12-10 20:41:38,506 - INFO - Epoch 23 - TRAIN | Loss: 1.2919 | Acc: 0.4854 | F1: 0.4625 | PR-AUC: 0.4436 | AUC-OvO: 0.8186 | AUC-OvR: 0.8182
2025-12-10 20:41:38,687 - INFO - Epoch 24 - VAL | Loss: 1.5794 | Acc: 0.2308 | F1: 0.2185 | PR-AUC: 0.3117 | AUC-OvO: 0.6898 | AUC-OvR: 0.6932
2025-12-10 20:41:38,730 - INFO - Epoch 24 - TRAIN | Loss: 1.1200 | Acc: 0.4854 | F1: 0.4660 | PR-AUC: 0.5747 | AUC-OvO: 0.8768 | AUC-OvR: 0.8742
2025-12-10 20:41:38,903 - INFO - Epoch 25 - VAL | Loss: 1.5728 | Acc: 0.2308 | F1: 0.2148 | PR-AUC: 0.3202 | AUC-OvO: 0.6988 | AUC-OvR: 0.6995
2025-12-10 20:41:38,927 - INFO - Epoch 25 - TRAIN | Loss: 1.1623 | Acc: 0.4078 | F1: 0.4038 | PR-AUC: 0.5030 | AUC-OvO: 0.8580 | AUC-OvR: 0.8579
2025-12-10 20:41:39,124 - INFO - Epoch 26 - VAL | Loss: 1.5957 | Acc: 0.2308 | F1: 0.2164 | PR-AUC: 0.3211 | AUC-OvO: 0.6993 | AUC-OvR: 0.6986
2025-12-10 20:41:39,148 - INFO - Epoch 26 - TRAIN | Loss: 1.1998 | Acc: 0.5049 | F1: 0.4695 | PR-AUC: 0.4848 | AUC-OvO: 0.8388 | AUC-OvR: 0.8398
2025-12-10 20:41:39,356 - INFO - Epoch 27 - VAL | Loss: 1.6242 | Acc: 0.2308 | F1: 0.2148 | PR-AUC: 0.3169 | AUC-OvO: 0.6983 | AUC-OvR: 0.6994
2025-12-10 20:41:39,383 - INFO - Epoch 27 - TRAIN | Loss: 1.1824 | Acc: 0.4660 | F1: 0.4129 | PR-AUC: 0.4792 | AUC-OvO: 0.8504 | AUC-OvR: 0.8487
2025-12-10 20:41:39,563 - INFO - Epoch 28 - VAL | Loss: 1.6141 | Acc: 0.2308 | F1: 0.2023 | PR-AUC: 0.3203 | AUC-OvO: 0.6964 | AUC-OvR: 0.7005
2025-12-10 20:41:39,593 - INFO - Epoch 28 - TRAIN | Loss: 1.1139 | Acc: 0.5728 | F1: 0.5531 | PR-AUC: 0.5897 | AUC-OvO: 0.8862 | AUC-OvR: 0.8859
2025-12-10 20:41:39,787 - INFO - Epoch 29 - VAL | Loss: 1.6717 | Acc: 0.2692 | F1: 0.2276 | PR-AUC: 0.3249 | AUC-OvO: 0.7123 | AUC-OvR: 0.7093
2025-12-10 20:41:39,817 - INFO - Epoch 29 - TRAIN | Loss: 1.1233 | Acc: 0.5146 | F1: 0.5087 | PR-AUC: 0.5964 | AUC-OvO: 0.8838 | AUC-OvR: 0.8806
2025-12-10 20:41:40,006 - INFO - Epoch 30 - VAL | Loss: 1.5438 | Acc: 0.2692 | F1: 0.2513 | PR-AUC: 0.3571 | AUC-OvO: 0.7394 | AUC-OvR: 0.7408
2025-12-10 20:41:40,044 - INFO - Epoch 30 - TRAIN | Loss: 1.1942 | Acc: 0.4272 | F1: 0.3982 | PR-AUC: 0.4919 | AUC-OvO: 0.8461 | AUC-OvR: 0.8434
2025-12-10 20:41:40,199 - INFO - Epoch 31 - VAL | Loss: 1.4971 | Acc: 0.2308 | F1: 0.2249 | PR-AUC: 0.3840 | AUC-OvO: 0.7518 | AUC-OvR: 0.7517
2025-12-10 20:41:40,249 - INFO - Epoch 31 - TRAIN | Loss: 1.1638 | Acc: 0.4466 | F1: 0.4373 | PR-AUC: 0.5249 | AUC-OvO: 0.8549 | AUC-OvR: 0.8535
2025-12-10 20:41:40,549 - INFO - Epoch 32 - VAL | Loss: 1.5231 | Acc: 0.2308 | F1: 0.2262 | PR-AUC: 0.3584 | AUC-OvO: 0.7203 | AUC-OvR: 0.7283
2025-12-10 20:41:40,572 - INFO - Epoch 32 - TRAIN | Loss: 1.1793 | Acc: 0.4951 | F1: 0.4626 | PR-AUC: 0.4747 | AUC-OvO: 0.8468 | AUC-OvR: 0.8454
2025-12-10 20:41:40,717 - INFO - Epoch 33 - VAL | Loss: 1.5852 | Acc: 0.1923 | F1: 0.1983 | PR-AUC: 0.3601 | AUC-OvO: 0.7031 | AUC-OvR: 0.7122
2025-12-10 20:41:40,766 - INFO - Epoch 33 - TRAIN | Loss: 1.1056 | Acc: 0.4951 | F1: 0.4503 | PR-AUC: 0.5446 | AUC-OvO: 0.8643 | AUC-OvR: 0.8666
2025-12-10 20:41:40,956 - INFO - Epoch 34 - VAL | Loss: 1.7780 | Acc: 0.1923 | F1: 0.1907 | PR-AUC: 0.3436 | AUC-OvO: 0.7077 | AUC-OvR: 0.7093
2025-12-10 20:41:41,001 - INFO - Epoch 34 - TRAIN | Loss: 1.0292 | Acc: 0.5631 | F1: 0.5473 | PR-AUC: 0.6079 | AUC-OvO: 0.8860 | AUC-OvR: 0.8837
2025-12-10 20:41:41,190 - INFO - Epoch 35 - VAL | Loss: 1.6203 | Acc: 0.2692 | F1: 0.2476 | PR-AUC: 0.3562 | AUC-OvO: 0.7159 | AUC-OvR: 0.7174
2025-12-10 20:41:41,241 - INFO - Epoch 35 - TRAIN | Loss: 1.1096 | Acc: 0.5243 | F1: 0.5157 | PR-AUC: 0.5687 | AUC-OvO: 0.8657 | AUC-OvR: 0.8649
2025-12-10 20:41:41,463 - INFO - Epoch 36 - VAL | Loss: 1.5274 | Acc: 0.2692 | F1: 0.2523 | PR-AUC: 0.3535 | AUC-OvO: 0.7109 | AUC-OvR: 0.7166
2025-12-10 20:41:41,540 - INFO - Epoch 36 - TRAIN | Loss: 1.1380 | Acc: 0.4951 | F1: 0.4728 | PR-AUC: 0.5212 | AUC-OvO: 0.8601 | AUC-OvR: 0.8601
2025-12-10 20:41:41,715 - INFO - Epoch 37 - VAL | Loss: 1.6641 | Acc: 0.3077 | F1: 0.2916 | PR-AUC: 0.3620 | AUC-OvO: 0.7230 | AUC-OvR: 0.7181
2025-12-10 20:41:41,756 - INFO - Epoch 37 - TRAIN | Loss: 1.0890 | Acc: 0.4951 | F1: 0.4876 | PR-AUC: 0.5979 | AUC-OvO: 0.8794 | AUC-OvR: 0.8747
2025-12-10 20:41:41,928 - INFO - Epoch 38 - VAL | Loss: 1.6073 | Acc: 0.3077 | F1: 0.2574 | PR-AUC: 0.3328 | AUC-OvO: 0.7064 | AUC-OvR: 0.7135
2025-12-10 20:41:41,986 - INFO - Epoch 38 - TRAIN | Loss: 1.0344 | Acc: 0.4757 | F1: 0.4816 | PR-AUC: 0.6401 | AUC-OvO: 0.8930 | AUC-OvR: 0.8900
2025-12-10 20:41:42,143 - INFO - Epoch 39 - VAL | Loss: 1.6032 | Acc: 0.2692 | F1: 0.2214 | PR-AUC: 0.3167 | AUC-OvO: 0.6963 | AUC-OvR: 0.7038
2025-12-10 20:41:42,193 - INFO - Epoch 39 - TRAIN | Loss: 0.9825 | Acc: 0.6117 | F1: 0.6063 | PR-AUC: 0.6662 | AUC-OvO: 0.9095 | AUC-OvR: 0.9072
2025-12-10 20:41:42,335 - INFO - Epoch 40 - VAL | Loss: 1.5784 | Acc: 0.2308 | F1: 0.1965 | PR-AUC: 0.3401 | AUC-OvO: 0.6858 | AUC-OvR: 0.6927
2025-12-10 20:41:42,373 - INFO - Epoch 40 - TRAIN | Loss: 1.0618 | Acc: 0.5146 | F1: 0.4957 | PR-AUC: 0.5854 | AUC-OvO: 0.8787 | AUC-OvR: 0.8809
2025-12-10 20:41:42,558 - INFO - Epoch 41 - VAL | Loss: 1.7492 | Acc: 0.2308 | F1: 0.2135 | PR-AUC: 0.3423 | AUC-OvO: 0.6929 | AUC-OvR: 0.6938
2025-12-10 20:41:42,605 - INFO - Epoch 41 - TRAIN | Loss: 1.1107 | Acc: 0.4175 | F1: 0.4173 | PR-AUC: 0.5476 | AUC-OvO: 0.8633 | AUC-OvR: 0.8633
2025-12-10 20:41:42,792 - INFO - Epoch 42 - VAL | Loss: 1.8354 | Acc: 0.3462 | F1: 0.2644 | PR-AUC: 0.3454 | AUC-OvO: 0.7314 | AUC-OvR: 0.7306
2025-12-10 20:41:42,821 - INFO - Epoch 42 - TRAIN | Loss: 0.9992 | Acc: 0.5146 | F1: 0.5156 | PR-AUC: 0.6262 | AUC-OvO: 0.8946 | AUC-OvR: 0.8925
2025-12-10 20:41:43,047 - INFO - Epoch 43 - VAL | Loss: 1.6282 | Acc: 0.2308 | F1: 0.2143 | PR-AUC: 0.3826 | AUC-OvO: 0.7470 | AUC-OvR: 0.7501
2025-12-10 20:41:43,075 - INFO - Epoch 43 - TRAIN | Loss: 0.9326 | Acc: 0.6505 | F1: 0.6245 | PR-AUC: 0.6561 | AUC-OvO: 0.9133 | AUC-OvR: 0.9145
2025-12-10 20:41:43,224 - INFO - Epoch 44 - VAL | Loss: 1.6967 | Acc: 0.2692 | F1: 0.2665 | PR-AUC: 0.3766 | AUC-OvO: 0.7511 | AUC-OvR: 0.7548
2025-12-10 20:41:43,264 - INFO - Epoch 44 - TRAIN | Loss: 0.8492 | Acc: 0.5728 | F1: 0.5617 | PR-AUC: 0.7282 | AUC-OvO: 0.9282 | AUC-OvR: 0.9256
2025-12-10 20:41:43,392 - INFO - Epoch 45 - VAL | Loss: 1.8130 | Acc: 0.3077 | F1: 0.2685 | PR-AUC: 0.3414 | AUC-OvO: 0.7269 | AUC-OvR: 0.7351
2025-12-10 20:41:43,435 - INFO - Epoch 45 - TRAIN | Loss: 0.9495 | Acc: 0.5534 | F1: 0.5544 | PR-AUC: 0.6605 | AUC-OvO: 0.9002 | AUC-OvR: 0.8998
2025-12-10 20:41:43,613 - INFO - Epoch 46 - VAL | Loss: 1.5717 | Acc: 0.3462 | F1: 0.2998 | PR-AUC: 0.4051 | AUC-OvO: 0.7500 | AUC-OvR: 0.7541
2025-12-10 20:41:43,659 - INFO - Epoch 46 - TRAIN | Loss: 0.8948 | Acc: 0.6117 | F1: 0.6001 | PR-AUC: 0.6794 | AUC-OvO: 0.9193 | AUC-OvR: 0.9173
2025-12-10 20:41:43,836 - INFO - Epoch 47 - VAL | Loss: 1.8744 | Acc: 0.2308 | F1: 0.1792 | PR-AUC: 0.3381 | AUC-OvO: 0.7145 | AUC-OvR: 0.7219
2025-12-10 20:41:43,893 - INFO - Epoch 47 - TRAIN | Loss: 0.8327 | Acc: 0.6214 | F1: 0.6296 | PR-AUC: 0.7271 | AUC-OvO: 0.9331 | AUC-OvR: 0.9307
2025-12-10 20:41:44,041 - INFO - Epoch 48 - VAL | Loss: 2.2525 | Acc: 0.2308 | F1: 0.2241 | PR-AUC: 0.3268 | AUC-OvO: 0.6884 | AUC-OvR: 0.7019
2025-12-10 20:41:44,082 - INFO - Epoch 48 - TRAIN | Loss: 0.8157 | Acc: 0.6311 | F1: 0.6337 | PR-AUC: 0.7170 | AUC-OvO: 0.9291 | AUC-OvR: 0.9235
2025-12-10 20:41:44,190 - INFO - Epoch 49 - VAL | Loss: 1.8652 | Acc: 0.1923 | F1: 0.1595 | PR-AUC: 0.3277 | AUC-OvO: 0.7003 | AUC-OvR: 0.7090
2025-12-10 20:41:44,226 - INFO - Epoch 49 - TRAIN | Loss: 0.7291 | Acc: 0.7476 | F1: 0.7526 | PR-AUC: 0.8451 | AUC-OvO: 0.9540 | AUC-OvR: 0.9531
2025-12-10 20:41:44,262 - INFO - 
Training completed at: 2025-12-10 20:41:44
2025-12-10 20:41:44,263 - INFO - Best checkpoint saved: /work/data/export/checkpoints_v2/best_model_pr_epoch=46_val_pr_auc=0.4051-v3.ckpt
2025-12-10 20:41:44,263 - INFO - Best PR-AUC (macro): 0.4051
2025-12-10 20:41:50,294 - INFO - 
================================================================================
2025-12-10 20:41:50,299 - INFO - MODEL EVALUATION - Loading Best Model
2025-12-10 20:41:50,300 - INFO - ================================================================================
2025-12-10 20:41:50,414 - INFO - Best model loaded from: /work/data/export/checkpoints_v2/best_model_pr_epoch=46_val_pr_auc=0.4051-v3.ckpt
2025-12-10 20:41:50,415 - INFO - Device: cuda
2025-12-10 20:41:50,472 - INFO - 
================================================================================
2025-12-10 20:41:50,473 - INFO - VALIDATION RESULTS (Best Model)
2025-12-10 20:41:50,474 - INFO - ================================================================================
2025-12-10 20:41:50,474 - INFO - Training Set:
2025-12-10 20:41:50,475 - INFO -   Accuracy:         0.7573
2025-12-10 20:41:50,476 - INFO -   F1 Score (macro): 0.7437
2025-12-10 20:41:50,477 - INFO -   PR-AUC (macro):   0.8809
2025-12-10 20:41:50,478 - INFO -   AUC-ROC (OvO):    0.9721
2025-12-10 20:41:50,478 - INFO -   AUC-ROC (OvR):    0.9689
2025-12-10 20:41:50,479 - INFO - 
Validation Set:
2025-12-10 20:41:50,480 - INFO -   Accuracy:         0.3462
2025-12-10 20:41:50,481 - INFO -   F1 Score (macro): 0.2998
2025-12-10 20:41:50,481 - INFO -   PR-AUC (macro):   0.4051 ← PRIMARY METRIC
2025-12-10 20:41:50,482 - INFO -   AUC-ROC (OvO):    0.7500 
2025-12-10 20:41:50,484 - INFO -   AUC-ROC (OvR):    0.7541 
2025-12-10 20:41:51,629 - INFO - 
================================================================================
2025-12-10 20:41:51,630 - INFO - TEST SET EVALUATION - CNN Model
2025-12-10 20:41:51,631 - INFO - ================================================================================
2025-12-10 20:41:51,632 - INFO - Loading test data from:
2025-12-10 20:41:51,633 - INFO -   Preprocessed: /work/data/export/segments_preproc_24_test.csv
2025-12-10 20:41:51,633 - INFO -   Raw (for baseline): /work/data/export/segments_test_raw.csv
2025-12-10 20:41:51,643 - INFO - Test set loaded: 15 segments
2025-12-10 20:41:51,644 - INFO - Test label distribution:
2025-12-10 20:41:51,645 - INFO -   Bullish Normal: 4 samples (26.7%)
2025-12-10 20:41:51,645 - INFO -   Bearish Pennant: 3 samples (20.0%)
2025-12-10 20:41:51,646 - INFO -   Bearish Normal: 3 samples (20.0%)
2025-12-10 20:41:51,646 - INFO -   Bullish Wedge: 2 samples (13.3%)
2025-12-10 20:41:51,647 - INFO -   Bullish Pennant: 2 samples (13.3%)
2025-12-10 20:41:51,648 - INFO -   Bearish Wedge: 1 samples (6.7%)
2025-12-10 20:41:51,670 - INFO - 
================================================================================
2025-12-10 20:41:51,670 - INFO - FINAL EVALUATION - Test Set Results (CNN Model)
2025-12-10 20:41:51,671 - INFO - ================================================================================
2025-12-10 20:41:51,672 - INFO - Accuracy:         0.3333
2025-12-10 20:41:51,673 - INFO - F1 Score (macro): 0.2611
2025-12-10 20:41:51,673 - INFO - PR-AUC (macro):   0.4053 ← PRIMARY METRIC
2025-12-10 20:41:51,674 - INFO - AUC-ROC (OvO):    0.6537
2025-12-10 20:41:51,674 - INFO - AUC-ROC (OvR):    0.6714
2025-12-10 20:41:51,677 - INFO - 
Confusion Matrix (Test Set):
2025-12-10 20:41:51,678 - INFO - Classes: [np.str_('Bearish Normal'), np.str_('Bearish Pennant'), np.str_('Bearish Wedge'), np.str_('Bullish Normal'), np.str_('Bullish Pennant'), np.str_('Bullish Wedge')]
2025-12-10 20:41:51,678 - INFO -   Bearish Normal: [np.int64(2), np.int64(0), np.int64(1), np.int64(0), np.int64(0), np.int64(0)]
2025-12-10 20:41:51,679 - INFO -   Bearish Pennant: [np.int64(0), np.int64(1), np.int64(2), np.int64(0), np.int64(0), np.int64(0)]
2025-12-10 20:41:51,680 - INFO -   Bearish Wedge: [np.int64(1), np.int64(0), np.int64(0), np.int64(0), np.int64(0), np.int64(0)]
2025-12-10 20:41:51,681 - INFO -   Bullish Normal: [np.int64(0), np.int64(0), np.int64(0), np.int64(2), np.int64(2), np.int64(0)]
2025-12-10 20:41:51,681 - INFO -   Bullish Pennant: [np.int64(0), np.int64(1), np.int64(0), np.int64(1), np.int64(0), np.int64(0)]
2025-12-10 20:41:51,682 - INFO -   Bullish Wedge: [np.int64(0), np.int64(0), np.int64(0), np.int64(1), np.int64(1), np.int64(0)]
2025-12-10 20:41:51,683 - INFO - 
Detailed Classification Report (Test Set):
2025-12-10 20:41:51,688 - INFO -                    precision    recall  f1-score   support
2025-12-10 20:41:51,689 - INFO -    Bearish Normal       0.67      0.67      0.67         3
2025-12-10 20:41:51,690 - INFO -   Bearish Pennant       0.50      0.33      0.40         3
2025-12-10 20:41:51,690 - INFO -     Bearish Wedge       0.00      0.00      0.00         1
2025-12-10 20:41:51,691 - INFO -    Bullish Normal       0.50      0.50      0.50         4
2025-12-10 20:41:51,691 - INFO -   Bullish Pennant       0.00      0.00      0.00         2
2025-12-10 20:41:51,692 - INFO -     Bullish Wedge       0.00      0.00      0.00         2
2025-12-10 20:41:51,693 - INFO -          accuracy                           0.33        15
2025-12-10 20:41:51,693 - INFO -         macro avg       0.28      0.25      0.26        15
2025-12-10 20:41:51,694 - INFO -      weighted avg       0.37      0.33      0.35        15
2025-12-10 20:41:52,068 - INFO - 
================================================================================
2025-12-10 20:41:52,069 - INFO - FINAL MODEL COMPARISON - Test Set Performance
2025-12-10 20:41:52,070 - INFO - ================================================================================
2025-12-10 20:41:52,070 - INFO - 
CNN Model (Deep Learning):
2025-12-10 20:41:52,071 - INFO -   Accuracy:         0.3333
2025-12-10 20:41:52,071 - INFO -   F1 Score (macro): 0.2611
2025-12-10 20:41:52,072 - INFO -   PR-AUC (macro):   0.4053
2025-12-10 20:41:52,073 - INFO -   AUC-ROC (OvO):    0.6537
2025-12-10 20:41:52,073 - INFO -   AUC-ROC (OvR):    0.6714
2025-12-10 20:41:52,074 - INFO - 
Baseline Model (Heuristic):
2025-12-10 20:41:52,074 - INFO -   Accuracy:         0.2667
2025-12-10 20:41:52,075 - INFO -   F1 Score (macro): 0.1889
2025-12-10 20:41:52,076 - INFO - 
Improvement (CNN vs Baseline):
2025-12-10 20:41:52,076 - INFO -   Accuracy:  +0.0667 (+25.0%)
2025-12-10 20:41:52,077 - INFO -   F1 Score:  +0.0722 (+38.2%)
2025-12-10 20:41:52,077 - INFO - 
================================================================================
2025-12-10 20:41:52,078 - INFO - EXPERIMENT COMPLETED SUCCESSFULLY
2025-12-10 20:41:52,079 - INFO - Completed at: 2025-12-10 20:41:52
2025-12-10 20:41:52,079 - INFO - ================================================================================
2025-12-10 21:14:54,648 - INFO - ================================================================================
2025-12-10 21:14:54,649 - INFO - DATA PREPROCESSING PIPELINE
2025-12-10 21:14:54,649 - INFO - Started at: 2025-12-10 21:14:54
2025-12-10 21:14:54,649 - INFO - ================================================================================
2025-12-10 21:14:55,087 - INFO - Found 4 JSON annotation files
2025-12-10 21:14:55,087 - INFO - Processing JSON 1/4: /work/data/AY1PC8/BullFlag_Detector_Labeling_AY1PC8.json
2025-12-10 21:14:55,097 - INFO -   Loaded 2 annotation entries
2025-12-10 21:14:55,378 - INFO -   Added 77 segments, total: 77
2025-12-10 21:14:55,378 - INFO - Processing JSON 2/4: /work/data/GFTYRV/project-4-at-2025-10-30-12-12-aaf7a367.json
2025-12-10 21:14:55,388 - INFO -   Loaded 27 annotation entries
2025-12-10 21:14:55,665 - INFO -   Added 58 segments, total: 135
2025-12-10 21:14:55,665 - INFO - Processing JSON 3/4: /work/data/XOBJYX/labels.json
2025-12-10 21:14:55,672 - INFO -   Loaded 3 annotation entries
2025-12-10 21:14:55,751 - INFO -   Added 32 segments, total: 167
2025-12-10 21:14:55,751 - INFO - Processing JSON 4/4: /work/data/YH6M5S/YH6M5S_labels.json
2025-12-10 21:14:55,759 - INFO -   Loaded 1 annotation entries
2025-12-10 21:14:55,893 - INFO -   Added 54 segments, total: 221
2025-12-10 21:14:55,893 - INFO - 
Total labeled segments extracted: 221
2025-12-10 21:14:55,894 - INFO - 
Label distribution:
2025-12-10 21:14:55,895 - INFO -   Bullish Normal: 57
2025-12-10 21:14:55,895 - INFO -   Bearish Normal: 56
2025-12-10 21:14:55,895 - INFO -   Bearish Pennant: 32
2025-12-10 21:14:55,895 - INFO -   Bullish Wedge: 27
2025-12-10 21:14:55,895 - INFO -   Bullish Pennant: 27
2025-12-10 21:14:55,896 - INFO -   Bearish Wedge: 22
2025-12-10 21:14:55,901 - INFO - 
Saved metadata: /work/data/export/segments_meta.csv
2025-12-10 21:14:55,901 - INFO - 
Creating combined segments CSV...
2025-12-10 21:14:56,020 - INFO - Saved combined segments: /work/data/export/segments_values.csv
2025-12-10 21:14:56,020 - INFO - 
Saving segments to HDF5...
2025-12-10 21:14:56,279 - INFO - Saved HDF5 segments: /work/data/export/segments.h5
2025-12-10 21:14:56,280 - INFO - 
================================================================================
2025-12-10 21:14:56,280 - INFO - TRAIN/TEST SPLIT AND PREPROCESSING
2025-12-10 21:14:56,280 - INFO - ================================================================================
2025-12-10 21:14:56,289 - INFO - Loaded segments: (4951, 8)
2025-12-10 21:14:56,902 - INFO - Total unique segments: 144
2025-12-10 21:14:56,904 - INFO - Train segments: 129 (89.6%)
2025-12-10 21:14:56,904 - INFO - Test segments: 15 (10.4%)
2025-12-10 21:14:56,905 - INFO - 
Train data shape: (4527, 8)
2025-12-10 21:14:56,905 - INFO - Test data shape: (424, 8)
2025-12-10 21:14:56,906 - INFO - 
Train label distribution:
2025-12-10 21:14:56,907 - INFO -   Bullish Normal: 36
2025-12-10 21:14:56,907 - INFO -   Bearish Normal: 24
2025-12-10 21:14:56,907 - INFO -   Bearish Pennant: 23
2025-12-10 21:14:56,907 - INFO -   Bullish Pennant: 20
2025-12-10 21:14:56,907 - INFO -   Bearish Wedge: 13
2025-12-10 21:14:56,908 - INFO -   Bullish Wedge: 13
2025-12-10 21:14:56,908 - INFO - 
Test label distribution:
2025-12-10 21:14:56,909 - INFO -   Bullish Normal: 4
2025-12-10 21:14:56,909 - INFO -   Bearish Pennant: 3
2025-12-10 21:14:56,909 - INFO -   Bearish Normal: 3
2025-12-10 21:14:56,909 - INFO -   Bullish Wedge: 2
2025-12-10 21:14:56,909 - INFO -   Bullish Pennant: 2
2025-12-10 21:14:56,910 - INFO -   Bearish Wedge: 1
2025-12-10 21:14:56,916 - INFO - 
Saved test raw data: /work/data/export/segments_test_raw.csv
2025-12-10 21:14:56,916 - INFO - 
Processing training segments...
2025-12-10 21:14:57,121 - INFO - Processing test segments...
2025-12-10 21:14:57,145 - INFO - 
Processed train shape: (3096, 12)
2025-12-10 21:14:57,145 - INFO - Processed test shape: (360, 12)
2025-12-10 21:14:57,145 - INFO - Features: ['open_norm', 'high_norm', 'low_norm', 'close_norm', 'vol_close', 'vol_high_low', 'compression_ratio', 'trend']
2025-12-10 21:14:57,181 - INFO - 
Saved training data: /work/data/export/segments_preproc_24.csv
2025-12-10 21:14:57,181 - INFO -   Rows: 3096, Segments: 129
2025-12-10 21:14:57,189 - INFO - 
Saved test data: /work/data/export/segments_preproc_24_test.csv
2025-12-10 21:14:57,189 - INFO -   Rows: 360, Segments: 15
2025-12-10 21:14:57,190 - INFO - 
================================================================================
2025-12-10 21:14:57,190 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-12-10 21:14:57,190 - INFO - Completed at: 2025-12-10 21:14:57
2025-12-10 21:14:57,190 - INFO - ================================================================================
2025-12-10 21:15:25,709 - INFO - ================================================================================
2025-12-10 21:15:25,709 - INFO - DATA PREPROCESSING PIPELINE
2025-12-10 21:15:25,710 - INFO - Started at: 2025-12-10 21:15:25
2025-12-10 21:15:25,710 - INFO - ================================================================================
2025-12-10 21:15:26,173 - INFO - Found 4 JSON annotation files
2025-12-10 21:15:26,173 - INFO - Processing JSON 1/4: /work/data/AY1PC8/BullFlag_Detector_Labeling_AY1PC8.json
2025-12-10 21:15:26,176 - INFO -   Loaded 2 annotation entries
2025-12-10 21:15:26,412 - INFO -   Added 77 segments, total: 77
2025-12-10 21:15:26,412 - INFO - Processing JSON 2/4: /work/data/GFTYRV/project-4-at-2025-10-30-12-12-aaf7a367.json
2025-12-10 21:15:26,415 - INFO -   Loaded 27 annotation entries
2025-12-10 21:15:26,572 - INFO -   Added 58 segments, total: 135
2025-12-10 21:15:26,572 - INFO - Processing JSON 3/4: /work/data/XOBJYX/labels.json
2025-12-10 21:15:26,575 - INFO -   Loaded 3 annotation entries
2025-12-10 21:15:26,630 - INFO -   Added 32 segments, total: 167
2025-12-10 21:15:26,631 - INFO - Processing JSON 4/4: /work/data/YH6M5S/YH6M5S_labels.json
2025-12-10 21:15:26,633 - INFO -   Loaded 1 annotation entries
2025-12-10 21:15:26,757 - INFO -   Added 54 segments, total: 221
2025-12-10 21:15:26,757 - INFO - 
Total labeled segments extracted: 221
2025-12-10 21:15:26,758 - INFO - 
Label distribution:
2025-12-10 21:15:26,759 - INFO -   Bullish Normal: 57
2025-12-10 21:15:26,759 - INFO -   Bearish Normal: 56
2025-12-10 21:15:26,759 - INFO -   Bearish Pennant: 32
2025-12-10 21:15:26,759 - INFO -   Bullish Wedge: 27
2025-12-10 21:15:26,760 - INFO -   Bullish Pennant: 27
2025-12-10 21:15:26,760 - INFO -   Bearish Wedge: 22
2025-12-10 21:15:26,764 - INFO - 
Saved metadata: /work/data/export/segments_meta.csv
2025-12-10 21:15:26,764 - INFO - 
Creating combined segments CSV...
2025-12-10 21:15:26,882 - INFO - Saved combined segments: /work/data/export/segments_values.csv
2025-12-10 21:15:26,882 - INFO - 
Saving segments to HDF5...
2025-12-10 21:15:27,158 - INFO - Saved HDF5 segments: /work/data/export/segments.h5
2025-12-10 21:15:27,158 - INFO - 
================================================================================
2025-12-10 21:15:27,159 - INFO - TRAIN/TEST SPLIT AND PREPROCESSING
2025-12-10 21:15:27,159 - INFO - ================================================================================
2025-12-10 21:15:27,166 - INFO - Loaded segments: (4951, 8)
2025-12-10 21:15:27,461 - INFO - Total unique segments: 144
2025-12-10 21:15:27,463 - INFO - Train segments: 129 (89.6%)
2025-12-10 21:15:27,463 - INFO - Test segments: 15 (10.4%)
2025-12-10 21:15:27,464 - INFO - 
Train data shape: (4527, 8)
2025-12-10 21:15:27,464 - INFO - Test data shape: (424, 8)
2025-12-10 21:15:27,465 - INFO - 
Train label distribution:
2025-12-10 21:15:27,465 - INFO -   Bullish Normal: 36
2025-12-10 21:15:27,466 - INFO -   Bearish Normal: 24
2025-12-10 21:15:27,466 - INFO -   Bearish Pennant: 23
2025-12-10 21:15:27,466 - INFO -   Bullish Pennant: 20
2025-12-10 21:15:27,466 - INFO -   Bearish Wedge: 13
2025-12-10 21:15:27,466 - INFO -   Bullish Wedge: 13
2025-12-10 21:15:27,467 - INFO - 
Test label distribution:
2025-12-10 21:15:27,467 - INFO -   Bullish Normal: 4
2025-12-10 21:15:27,467 - INFO -   Bearish Pennant: 3
2025-12-10 21:15:27,468 - INFO -   Bearish Normal: 3
2025-12-10 21:15:27,468 - INFO -   Bullish Wedge: 2
2025-12-10 21:15:27,468 - INFO -   Bullish Pennant: 2
2025-12-10 21:15:27,468 - INFO -   Bearish Wedge: 1
2025-12-10 21:15:27,474 - INFO - 
Saved test raw data: /work/data/export/segments_test_raw.csv
2025-12-10 21:15:27,475 - INFO - 
Processing training segments...
2025-12-10 21:15:27,686 - INFO - Processing test segments...
2025-12-10 21:15:27,709 - INFO - 
Processed train shape: (3096, 12)
2025-12-10 21:15:27,709 - INFO - Processed test shape: (360, 12)
2025-12-10 21:15:27,709 - INFO - Features: ['open_norm', 'high_norm', 'low_norm', 'close_norm', 'vol_close', 'vol_high_low', 'compression_ratio', 'trend']
2025-12-10 21:15:27,744 - INFO - 
Saved training data: /work/data/export/segments_preproc_24.csv
2025-12-10 21:15:27,745 - INFO -   Rows: 3096, Segments: 129
2025-12-10 21:15:27,752 - INFO - 
Saved test data: /work/data/export/segments_preproc_24_test.csv
2025-12-10 21:15:27,753 - INFO -   Rows: 360, Segments: 15
2025-12-10 21:15:27,753 - INFO - 
================================================================================
2025-12-10 21:15:27,753 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-12-10 21:15:27,753 - INFO - Completed at: 2025-12-10 21:15:27
2025-12-10 21:15:27,754 - INFO - ================================================================================
